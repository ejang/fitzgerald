<!DOCTYPE html>
<!--[if lt IE 7 ]> <html dir="ltr" lang="en-US" class="ie6"> <![endif]-->
<!--[if IE 7 ]>    <html dir="ltr" lang="en-US" class="ie7"> <![endif]-->
<!--[if IE 8 ]>    <html dir="ltr" lang="en-US" class="ie8"> <![endif]-->
<!--[if IE 9 ]>    <html dir="ltr" lang="en-US" class="ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html dir="ltr" lang="en-US"> <!--<![endif]-->

<head>
  <meta charset="utf-8" />
  <title>Fitzgerald</title>
  <link rel="stylesheet" type="text/css" href="css/reset.css" />
  <link rel="stylesheet" type="text/css" href="css/demo.css" />
  <link rel="stylesheet" type="text/css" href="js/lib/jquery-ui-1.8.21.custom.css" />
  <link href='http://fonts.googleapis.com/css?family=Swanky+and+Moo+Moo|Shadows+Into+Light|Loved+by+the+King' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" type="text/css" href="css/style.css" />
  <!--[if IE]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
</head>

<body>
  <div id="dot-container" class="clearfix">
    <h3 class="dot-title"></h3>

    <div id="dot-sv"></div>

    <div class="dot-feedback-container">
      <button id="dot-add-feedback">Add a Comment</button>
      <form class="dot-survey-form">
        <label for="dot-survey-desc">Show us where this intersection can be improved!</label>
        <textarea id="dot-survey-desc" class="dot-survey-item" name="desc"></textarea>
      </form>
      <ul class="dot-feedback"></ul>
      <div class="dot-feedback-nav">
        <span class="dot-feedback-nav-prev"><a href="#">prev</a></span>
        <span class="dot-feedback-nav-state"></span>
        <span class="dot-feedback-nav-next"><a href="#">next</a></span>
      </div>
    </div>

    <div class="dot-slider-container">
      <div class="dot-tooltip dot-tooltip-youarehere">You Are Here</div>
      <div class="dot-tooltip dot-tooltip-comments"></div>
      <div class="dot-slider"></div>
      <div class="dot-feedback-activity"></div>
    </div>
  </div>

  <script src="https://maps.googleapis.com/maps/api/js?sensor=false"></script>
  <script src="js/lib/jquery-1.7.2.min.js"></script>
  <script src="js/lib/jquery-ui-1.8.21.custom.min.js"></script>
  <script src="js/lib/jquery.sparkline-2.0.min.js"></script>
  <script src="js/lib/json2.min.js"></script>
  <script src="js/lib/underscore-1.3.3.min.js"></script>
  <script src="js/lib/backbone-0.9.2.min.js"></script>
  <script src="js/lib/backbone.localStorage-min.js"></script>

  <script src="js/util.js"></script>
  <script src="js/routes.js"></script>
  <script src="js/models.js"></script>
  <script src="js/views.js"></script>
  <script src="js/test_data.js"></script>

  <script>
  Fitzgerald.AppView = Backbone.View.extend({
    initialize: function(){
      // Init the collection
      this.collection = new Fitzgerald.LocationCollection();

      // Init the views
      this.mapSlider = new Fitzgerald.NavigatorView({
        el: '.dot-slider', collection: this.collection
      });
      this.tooltip = new Fitzgerald.TooltipView({
        el: '.dot-tooltip-comments', collection: this.collection
      });
      this.youarehere = new Fitzgerald.YouarehereTooltipView({
        el: '.dot-tooltip-youarehere', collection: this.collection
      });
      this.feedbackActivity = new Fitzgerald.FeedbackActivityView({
        el: '.dot-feedback-activity', collection: this.collection
      });
      this.feedbackList = new Fitzgerald.FeedbackListView({
        el: '.dot-feedback-container',
        colors: ['yellow', 'blue', 'magenta'],
        collection: this.collection
      });
      this.streetview = new Fitzgerald.StreetviewView({
        el: '#dot-sv',
        collection: this.collection,
        panoOptions: {
          position: new google.maps.LatLng(0, 0),
          visible:true,
          addressControl: false,
          clickToGo: false,
          scrollwheel: false,
          linksControl: false,
          disableDoubleClickZoom: false,
          zoomControlOptions: {
            style: google.maps.ZoomControlStyle.SMALL
          }
        }
      });
      this.feedbackForm = new Fitzgerald.FeedbackFormView({
        el: '.dot-survey-form',
        showFormEl: '#dot-add-feedback',
        collection: this.collection,
        maxChars: 200
      });

      this.locationTitle = new Fitzgerald.LocationTitleView({
        el: '.dot-title',
        setTitle: function(title) {
          this.$el.html('Fourth Ave &amp; ' + title);
        }
      })

      // Fetch the location records
      this.collection.fetch();
    }
  });

  new Fitzgerald.AppView();
  </script>

</body>
</html>